<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Menu</title>
</head>
<body>

<h1>User Info</h1>
<p id="name"></p>
<p id="email"></p>

<script type="module">
  import { supabase } from './supabase.js';

  const { data: { user } } = await supabase.auth.getUser();

  if (!user) {
    window.location.href = "login.html";
  }

  document.getElementById("name").textContent = "Name: " + user.user_metadata.full_name;
  document.getElementById("email").textContent = "Email: " + user.email;

  await supabase.from("users").upsert({
      id: user.id,
      name: user.user_metadata.full_name,
      email: user.email
  });
</script>

</body>
</html>
